{% assign upsell_products = product.metafields.custom.upsell %}
{% assign upsell_product_ids = upsell_products | json_parse %}

<p>{{ upsell_products }}</p>

{% assign product_ids = 'gid://shopify/Product/8353335148800,gid://shopify/Product/8353334591744,gid://shopify/Product/8353332789504,gid://shopify/Product/8353332396288'
  | split: ','
%}

{% for product_id in product_ids %}
  {% assign handle = product_id | remove: 'gid://shopify/Product/' %}
  {% assign product = all_products[handle] %}
  {% if product %}
    <div class="product">
      <h2>{{ product.title }}</h2>
      <img src="{{ product.images[0] | img_url: 'large' }}" alt="{{ product.title }}">
      <p>{{ product.price | money }}</p>
    </div>
  {% else %}
    <p>Producto con ID {{ handle }} no encontrado.</p>
  {% endif %}
{% endfor %}
